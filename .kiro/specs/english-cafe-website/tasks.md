# Implementation Plan

## Overview

英会話カフェWebサイトの実装を段階的に進めるためのタスクリスト。各タスクはテスト駆動開発（TDD）アプローチで実装し、要件書と設計書に基づいて構築する。

## Task List

- [ ] 1. プロジェクト基盤セットアップ
  - [x] 1.1 モノレポ構造とDocker環境構築
    - モノレポディレクトリ構造作成
    - Docker + Docker Compose設定（frontend、backend、PostgreSQL）
    - 開発用ホットリロード環境構築
    - _Requirements: 全要件の基盤_

  - [x] 1.2 開発環境設定
    - ESLint、Prettier、Ruff、pytest設定
    - VS Code devcontainer設定（オプション）
    - 環境変数管理設定
    - _Requirements: 全要件の基盤_

  - [x] 1.3 GitHub設定とCI/CD
    - GitHubリポジトリ作成とブランチ戦略設定
    - GitHub Actions CI/CDパイプライン設定
    - Docker イメージビルド自動化
    - _Requirements: 全要件の基盤_

- [ ] 2. バックエンド基盤実装
  - [x] 2.1 FastAPIプロジェクト初期化とドメイン層実装
    - FastAPIアプリケーション初期化
    - ドメインエンティティ（Contact、Email値オブジェクト）実装
    - イベントバス基盤実装
    - _Requirements: 3.1, 3.4_

  - [x] 2.2 データベース設定とリポジトリ実装
    - PostgreSQL接続設定とAlembicマイグレーション設定
    - Contactリポジトリ実装とテスト作成
    - データベーススキーマ定義
    - _Requirements: 3.1, 3.4_

  - [x] 2.3 問い合わせAPI実装
    - 問い合わせフォーム送信APIエンドポイント実装
    - バリデーション機能とエラーハンドリング実装
    - メール送信サービス実装
    - APIテスト作成
    - _Requirements: 3.1, 3.2, 3.3, 3.4_

- [ ] 3. フロントエンド基盤実装
  - [x] 3.1 Next.jsプロジェクト初期化とレイアウト実装
    - Next.js 14 App Router設定
    - 基本レイアウトコンポーネント実装
    - Tailwind CSS設定とデザインシステム構築
    - _Requirements: 1.1, 4.1, 4.2_

  - [x] 3.2 ドメイン層とストア実装
    - フロントエンドContactエンティティ実装
    - Zustand状態管理ストア実装
    - イベントバス実装
    - _Requirements: 3.1, 3.4_

  - [x] 3.3 共通UIコンポーネント実装
    - ボタン、フォーム、カードなどの基本コンポーネント実装
    - レスポンシブデザイン対応
    - アクセシビリティ対応
    - コンポーネントテスト作成
    - _Requirements: 4.1, 4.2, 4.4_

- [ ] 4. ホームページ実装
  - [x] 4.1 ヒーローセクション実装
    - 魅力的なヒーローセクションコンポーネント実装
    - レスポンシブ画像最適化
    - アニメーション効果実装
    - _Requirements: 1.1, 4.1_

  - [x] 4.2 サービス概要セクション実装
    - レッスンタイプ、料金体系表示コンポーネント実装
    - 営業時間表示機能実装
    - _Requirements: 1.2_

  - [x] 4.3 講師紹介セクション実装
    - 講師カードコンポーネント実装
    - 講師プロフィール表示機能実装
    - _Requirements: 2.1_

  - [x] 4.4 顧客レビューセクション実装
    - レビュー表示コンポーネント実装
    - 星評価表示機能実装
    - _Requirements: 2.3_

- [ ] 5. 講師ページ実装
  - [x] 5.1 講師一覧ページ実装
    - 講師一覧表示機能実装
    - フィルタリング・検索機能実装
    - _Requirements: 2.1_

  - [x] 5.2 講師詳細ページ実装
    - 講師詳細情報表示実装
    - 専門分野・経歴表示実装
    - 問い合わせボタン連携実装
    - _Requirements: 2.1, 2.4_

- [ ] 6. レッスンページ実装
  - [x] 6.1 レッスン一覧ページ実装
    - レッスンタイプ別表示実装
    - 料金表示機能実装
    - _Requirements: 1.2, 2.2_

  - [x] 6.2 レッスン詳細ページ実装
    - レッスン詳細説明表示実装
    - 対象レベル表示実装
    - 体験レッスン申込ボタン実装
    - _Requirements: 2.2, 3.3_

- [ ] 7. 問い合わせページ実装
  - [x] 7.1 問い合わせフォーム実装
    - フォームコンポーネント実装
    - リアルタイムバリデーション実装
    - 送信状態管理実装
    - _Requirements: 3.1, 3.4_

  - [x] 7.2 SNS連携機能実装
    - LINE QRコード表示コンポーネント実装
    - Facebook・Instagram連携ボタン実装
    - SNSリダイレクト機能実装
    - _Requirements: 3.5, 3.6, 3.7, 3.8_

  - [x] 7.3 アクセス情報実装
    - Google Maps埋め込み実装
    - 住所・営業時間表示実装
    - アクセス方法説明実装
    - _Requirements: 1.3_

- [ ] 8. YouTube動画機能実装
  - [x] 8.1 YouTube埋め込みコンポーネント実装
    - YouTube動画埋め込みコンポーネント実装
    - レスポンシブ動画プレーヤー実装
    - _Requirements: 1.5_

  - [x] 8.2 動画コンテンツ統合
    - 講師紹介動画統合
    - レッスン風景動画統合
    - カフェ紹介動画統合
    - _Requirements: 1.5, 2.1_

- [ ] 9. SEO最適化実装
  - [x] 9.1 メタデータ設定実装
    - 各ページのメタタグ設定実装
    - Open Graph設定実装
    - 構造化データ実装
    - _Requirements: 5.1, 5.2_

  - [x] 9.2 パフォーマンス最適化実装
    - 画像最適化実装
    - コード分割実装
    - キャッシュ戦略実装
    - _Requirements: 4.3, 5.3_

- [ ] 10. テスト実装
  - [ ] 10.1 ユニットテスト実装
    - バックエンドユニットテスト実装
    - フロントエンドコンポーネントテスト実装
    - ドメインロジックテスト実装
    - _Requirements: 全要件のテスト保証_

  - [ ] 10.2 統合テスト実装
    - API統合テスト実装
    - フォーム送信フローテスト実装
    - _Requirements: 3.1, 3.4_

  - [ ] 10.3 E2Eテスト実装
    - 主要ユーザーフローE2Eテスト実装
    - モバイル・デスクトップ両対応テスト実装
    - _Requirements: 4.1, 4.2, 4.4_

- [ ] 11. デプロイメント設定
  - [ ] 11.1 Vercelデプロイ設定
    - フロントエンドVercelデプロイ設定
    - 環境変数設定
    - ドメイン設定
    - _Requirements: 全要件のデプロイ_

  - [ ] 11.2 Renderデプロイ設定
    - バックエンドRenderデプロイ設定
    - PostgreSQLデータベース設定
    - 環境変数設定
    - _Requirements: 3.1, 3.4_

- [ ] 12. セキュリティ対策実装
  - [ ] 12.1 フロントエンドセキュリティ実装
    - XSS対策（入力値サニタイゼーション、CSP設定）
    - CSRF対策（トークン検証）
    - セキュリティヘッダー設定
    - _Requirements: 6.1, 6.3, 6.6_

  - [ ] 12.2 バックエンドセキュリティ実装
    - SQLインジェクション対策（パラメータ化クエリ）
    - 入力値検証とレート制限実装
    - 将来のAIプロンプトインジェクション対策基盤実装
    - _Requirements: 6.2, 6.4, 6.5_

- [ ] 13. 管理機能実装（将来拡張）
  - [ ] 13.1 管理者認証機能実装
    - 管理者ログイン機能実装
    - JWT認証実装
    - 権限管理実装
    - _Requirements: 7.1_

  - [ ] 13.2 問い合わせ管理機能実装
    - 問い合わせ一覧表示実装
    - 問い合わせ詳細表示実装
    - 対応状況管理実装
    - _Requirements: 7.2, 7.3, 7.4_

- [ ] 14. 監視・ログ機能実装
  - [ ] 14.1 エラー監視実装
    - エラーログ記録機能実装
    - エラーページ実装
    - Sentry統合（オプション）
    - _Requirements: 8.1_

  - [ ] 14.2 システム監視実装
    - ヘルスチェック機能実装
    - アップタイム監視設定
    - アラート機能実装
    - _Requirements: 8.2, 8.3, 8.4_

- [ ] 15. 最終統合とテスト
  - [ ] 15.1 全機能統合テスト
    - 全機能の動作確認
    - パフォーマンステスト実行
    - セキュリティペネトレーションテスト実行
    - _Requirements: 全要件の最終確認_

  - [ ] 15.2 本番環境最終確認
    - 本番環境での動作確認
    - セキュリティ監視設定
    - バックアップ設定確認
    - _Requirements: 全要件の本番対応_

## Implementation Notes

### Development Approach
- **Docker環境**: 統一された開発環境でチーム開発効率化
- **テスト駆動開発**: 各機能実装前にテストを作成
- **段階的実装**: 基盤→コア機能→UI→最適化の順序
- **継続的統合**: 各タスク完了時にCI/CDパイプラインで自動テスト

### Quality Assurance
- **コードレビュー**: 各プルリクエストでコードレビュー実施
- **自動テスト**: ユニット・統合・E2Eテストの自動実行
- **セキュリティテスト**: 自動セキュリティスキャンとペネトレーションテスト
- **パフォーマンス監視**: Lighthouse CI による継続的パフォーマンス監視

### Risk Management
- **環境統一**: Docker環境により開発・本番環境の差異を最小化
- **外部API依存**: YouTube API、Google Maps APIの利用制限に注意
- **無料プラン制限**: Render、Vercelの無料プラン制限の監視
- **データ移行**: 将来の有料プラン移行時のデータ移行計画
- **GDPR/個人情報保護**: 問い合わせデータの適切な管理と削除機能
- **災害復旧**: データバックアップと復旧手順の策定
- **スケーラビリティ**: 将来のトラフィック増加への対応計画

### Success Criteria
- **全要件の実装完了**: 要件書の全Acceptance Criteriaを満たす
- **セキュリティ基準**: OWASP Top 10対策完了、セキュリティテスト合格
- **パフォーマンス目標**: Lighthouse スコア90以上
- **テストカバレッジ**: 80%以上のテストカバレッジ達成
- **レスポンシブ対応**: 全デバイスでの適切な表示確認